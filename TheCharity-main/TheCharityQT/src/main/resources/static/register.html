<!DOCTYPE html>
<html lang="en">
<head>
    <title>慈缘心链-爱心公益网</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <!-- FontAwesome CSS -->
    <link rel="stylesheet" href="css/font-awesome.min.css">

    <!-- ElegantFonts CSS -->
    <link rel="stylesheet" href="css/elegant-fonts.css">

    <!-- themify-icons CSS -->
    <link rel="stylesheet" href="css/themify-icons.css">

    <!-- Swiper CSS -->
    <link rel="stylesheet" href="css/swiper.min.css">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="css/bootstrap-theme.css">
    <link rel="stylesheet" href="./css/bt3.7.css?1">
    <link rel="Stylesheet" type="text/css" href="./css/mycore.css?e13?31" />
    <link rel="Stylesheet" type="text/css" href="./css/myatc.css?312?31" />

    <link rel="shortcut icon" href="https://cdn.vipcom.cc./image/czdywzs.png" type="image/x-icon" />

    <script src="./js/lang.js?31"></script>
    <script src="./js/jquery-1.11.3.min.js?31"></script>
    <style>
        /* CSS样式表 */
        a.btn.gradient-bg:active {
            color: cyan; /* 设置点击时的颜色为青色 */
        }
    </style>

</head>
<header class="site-header">
    <div class="cc_bgcc" data-skip-type="0" data-bd_bgtype="bggdcc" style="background-color:rgb(161, 216, 230);background-image: linear-gradient(to right top, #6bd17d, #85d67b, #9dda7b, #b2de7c, #c7e27f, #c5e787, #c2eb90, #c0f099, #a6f5ad, #8df8c3, #74fada, #5ffbf1);;background-size:auto;">
        <div class="container">
            <div class="row flex-wrap justify-content-center justify-content-lg-between align-items-lg-center">
                <div class="col-12 col-lg-6 d-none d-md-flex flex-wrap justify-content-center justify-content-lg-start mb-3 mb-lg-0">
                    <div class="header-bar-email" style="color: black;">
                        电子邮箱：<a href="#" style="color: black;">3181289794@qq.com</a>
                    </div><!-- .header-bar-email -->
                    <div class="header-bar-text" style="color: black;">
                        <p> 捐助热线：<span style="color: black;">19031528955</span></p>
                    </div><!-- .header-bar-text -->
                </div><!-- .col -->
                <div class="col-12 col-lg-6 d-flex flex-wrap justify-content-center justify-content-lg-end align-items-center">
                    <!-- 检查session是否有user -->
                    <!-- 有就显示用户+注销 否则显示登录和注册 -->
                    <div class="donate-btn" id="div_userInfo" style="margin-left: 2px;display: none">
    							<span>
    								<img alt="" style="cursor: pointer;" src="images/testimonial-1.jpg" onclick="changeAvatar()" id="t_img">
    								<input type="file" style="display: none;" id="edit_pIcon" onchange="upload(this,'pIcon')">
                                    <input type="hidden" id="pIcon">
    								<a href="profile.html" id="a_username">Jenifer Smith</a>
    							</span>
                    </div>
                    <div class="donate-btn" id="div_logout" style="margin-left: 2px;display: none">
                        <a href="#">注销</a>
                    </div>
                    <div class="donate-btn" id="div_login" style="margin-left: 2px;">
                        <a href="login.html">登录</a>
                    </div>
                    <div class="donate-btn" id="div_register" style="margin-left: 2px;">
                        <a href="register.html">注册</a>
                    </div>
                </div><!-- .col -->
            </div><!-- .row -->
        </div><!-- .container -->
    </div><!-- .top-header-bar -->

    <!--            <div class="nav-bar">-->
    <div class="container">
        <div class="row">
            <div class="col-12 d-flex flex-wrap justify-content-between align-items-center">
                <div class="site-branding d-flex align-items-center">
                    <a class="d-block" href="index.html" rel="home"><p>慈缘心链</p></a>
                </div><!-- .site-branding -->

                <nav class="site-navigation d-flex justify-content-end align-items-center">
                    <ul class="d-flex flex-column flex-lg-row justify-content-lg-end align-content-center">
                        <li class="current-menu-item"><a href="index.html">首页</a></li>
                        <li><a href="portfolio.html">相册</a></li>
                        <li><a href="allCauses.html">慈善项目</a></li>
                        <li><a href="about.html">成为志愿者</a></li>
                        <li><a href="news.html">新闻资讯</a></li>
                        <li><a href="causes.html">捐赠情况</a></li>
                    </ul>
                </nav><!-- .site-navigation -->
            </div><!-- .col -->
        </div><!-- .row -->
    </div><!-- .container -->
</header><!-- .site-header -->

<section class="forms">
    <div class="container">
        <div class="forms-grid">

            <!-- register -->
            <div class="register">
                <span class="fa fa-user-circle"></span>
                <strong>注册账号</strong>
                <form action="#" method="post" class="register-form" onsubmit="return false;">
                    <fieldset>
                        <div class="form">
                            <p><span style="color: red;" id="error_msg"></span></p>
                            <div class="form-row">
                                <label class="form-label" for="username">用户名：</label>
                                <input type="text" class="form-text" id="username">
                            </div>
                            <div class="form-row">
                                <label class="form-label" for="pwd">密码：</label>
                                <input type="password" class="form-text" id="pwd">
                            </div>
                            <div class="form-row">
                                <label class="form-label" for="pwdAgain">再次输入密码：</label>
                                <input type="password" class="form-text" id="pwdAgain">
                            </div>
                            <div class="form-row">
                                <label class="form-label" for="email">邮箱：</label>
                                <input type="email" class="form-text" id="email">
                            </div>
                            <br>
                            <div class="form-row">
                                <label class="form-label" for="emailCheckCode">邮箱验证码：</label>
                                <input type="text" class="form-text" style="width: 30%;" id="emailCheckCode">
                                <button style="background-color: aqua;margin-left: 15px;margin-bottom: 20px;" id="getCode" onclick="getCheckCode()">获取验证码</button>
                                <input type="text" id="realCheckCode" style="display: none">
                            </div>
                            <div class="form-row button-login">
                                <button class="btn btn-login" style="background-color: aqua;" onclick="register()">注册</button>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
            <!-- //register -->
        </div>

    </div>
</section>



<!--bkoutstart-->
<div id="bk_107202" data-mkid="0" data-mix-mkbkid="0_bk_107202" data-cover="https://cdn.vipcom.cc/Public/image/block/icon_3n.png?31"
     data-name="icon图标列表"
     data-file-path="Block/List/icon_3n"
     data-bid="107202"
     data-order="5"
     data-use-type=""
     data-vip-level="0"
     class="blockpos cc_bgcc_bak js-my-pblock autopd-bt-100"
     style="background-image:url();"  data-bgsrc="null" data-id="19327_bk_107202_bg"  data-href='' data-pmkid="0" data-img-type="css" data-is_del="" data-mb-show=""  data-class=""
     data-hide="1"
     data-hide-exp=""
     data-hide-status="0"
     data-align="center"
>

    <div style="display:none;" class="btn_set_ani"  data-mypop-ani-data="{bkani:{data:[{s:'设置内部动画效果',v:'0_bk_107202_bkani',c:'js_set_my_ani'}],def:'fadeInUp',type:'tag_select',title:'动画'}}" ></div>
    <div style="display:none;" class="btn_set_cc btn_set_bgcc"  data-mypop-data="{bkbgcc:{def:'#fff',type:'color',title:'内框背景色'}}" ></div>

    <div style="display:none;" class="btn_set_cc btn_set_ftcc"  data-mypop-data="{intro:{type:'intro',title:'注：如果您给目标单独设置了颜色，以下设置将没有效果'},bkftcc:{def:'bk_ftcc',data:[{s:'黑色',v:'bk_ftcc'},{s:'白色',v:'wt_ftcc'},{s:'灰色',v:'gray_ftcc'},{s:'自动主题色',v:'pubcc'}],type:'tag_select',title:'内框字体颜色'}}" ></div>

    <div style="display:none;" class="val_my_outline"  data-val="inneritemstd" ></div>
    <!--bkoutstart-->
    <div style="" class=" bktitbox container autopd-vt-bktit text-center" >
        <h1><lhz   data-id="19327_bk_107202_bktt_"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt"><span >加入我们，献出爱心</span></lhz></h1>
        <p><lhz  style="display:none;" data-id="19327_bk_107202_bkttdp_" data-pmkid="0" data-is_del="1" class="js-my-replace-txt js-my-hide-item"></lhz></p>
    </div>
    <!--bkoutend-->
    <!--bkoutstart-->

    <div id="bk_107202_blockrendbox" class="blockrendbox" >  <!--bkoutend-->
        <!--blockname icon图标列表 blocknameend-->

        <div class="container autopd-vt-big-bak  set_line_num"  data-now-lenm="3">
            <div class="row inner_set_num" data-key="lpk" data-lp-num="4" data-lp-title="">
                <div class="outitemstd  col-md-3 col-xs-12 autopadding15"  data-anim-obj ="0_bk_107202_bkani" data-kui-anim="fadeInUp" >
                    <div style="background-color:#fff;" class="text-center cc_bgcc inner_myset_style inneritemstd">
                        <div style="text-align:center;">
                            <div data-id="19327_bk_107202_btn51"  data-myscs-myiconst="iconweixin-copy" data-myscs-isdel="0" data-myscs-pubftsize="pubftsz80" data-myscs-cc_self="pubbtnuucc"   data-href='' data-btn-type="icon"  data-act="" class="pubcc js-my-btn-replace-set btn btn-default-my myiconfont  iconweixin-copy 0 pubftsz80 pubbtnuucc "   style="color:rgb(0, 142, 87);background-color:rgba(0, 0, 0, 0);">  </div>           </div>
                        <h3 class="bk_ftcc">
                            <lhz   data-id="19327_bk_107202_tt_1"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt"><span >微信xxx</span></lhz>          </h3>
                        <p class="bk_ftcc" style="padding-left:0px;">
                            <lhz   data-id="19327_bk_107202_tt_dp1"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt"><span >We Chat</span></lhz>          </p>
                    </div>
                </div>
                <div class="outitemstd  col-md-3 col-xs-12 autopadding15"  data-anim-obj ="0_bk_107202_bkani" data-kui-anim="fadeInUp" >
                    <div style="background-color:#fff;" class="text-center cc_bgcc inner_myset_style inneritemstd">
                        <div style="text-align:center;">
                            <div data-id="19327_bk_107202_btn52"  data-myscs-myiconst="iconqq" data-myscs-isdel="0" data-myscs-pubftsize="pubftsz80" data-myscs-cc_self="pubbtnuucc"   data-href='' data-btn-type="icon"  data-act="" class="pubcc js-my-btn-replace-set btn btn-default-my myiconfont  iconqq 0 pubftsz80 pubbtnuucc "   style="color:rgb(34, 174, 230);background-color:rgba(0, 0, 0, 0);">  </div>           </div>
                        <h3 class="bk_ftcc">
                            <lhz   data-id="19327_bk_107202_tt_2"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt"><span >QQxxx</span></lhz>          </h3>
                        <p class="bk_ftcc" style="padding-left:0px;">
                            <lhz   data-id="19327_bk_107202_tt_dp2"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt"><span >QQ</span></lhz>          </p>
                    </div>
                </div>
                <div class="outitemstd  col-md-3 col-xs-12 autopadding15"  data-anim-obj ="0_bk_107202_bkani" data-kui-anim="fadeInUp" >
                    <div style="background-color:#fff;" class="text-center cc_bgcc inner_myset_style inneritemstd">
                        <div style="text-align:center;">
                            <div data-id="19327_bk_107202_btn53"  data-myscs-myiconst="iconweibo" data-myscs-isdel="0" data-myscs-pubftsize="pubftsz80" data-myscs-cc_self="pubbtnuucc"   data-href='' data-btn-type="icon"  data-act="" class="pubcc js-my-btn-replace-set btn btn-default-my myiconfont  iconweibo 0 pubftsz80 pubbtnuucc "   style="color:rgb(215, 0, 64);background-color:rgba(0, 0, 0, 0);">  </div>           </div>
                        <h3 class="bk_ftcc">
                            <lhz   data-id="19327_bk_107202_tt_3"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt"><span >微博xxx</span></lhz>          </h3>
                        <p class="bk_ftcc" style="padding-left:0px;">
                            <lhz   data-id="19327_bk_107202_tt_dp3"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt">MicroBlog</lhz>          </p>
                    </div>
                </div>
                <div class="outitemstd  col-md-3 col-xs-12 autopadding15"  data-anim-obj ="0_bk_107202_bkani" data-kui-anim="fadeInUp" >
                    <div style="background-color:#fff;" class="text-center cc_bgcc inner_myset_style inneritemstd">
                        <div style="text-align:center;">
                            <div data-id="19327_bk_107202_btn54"  data-myscs-myiconst="iconicon-douyin" data-myscs-isdel="0" data-myscs-pubftsize="pubftsz80" data-myscs-cc_self="pubbtnuucc"   data-href='' data-btn-type="icon"  data-act="" class="pubcc js-my-btn-replace-set btn btn-default-my myiconfont  iconicon-douyin 0 pubftsz80 pubbtnuucc "   style="color:rgb(12, 12, 12);background-color:rgba(0, 0, 0, 0);">  </div>           </div>
                        <h3 class="bk_ftcc">
                            <lhz   data-id="19327_bk_107202_tt_4"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt"><span >抖音xxx</span></lhz>          </h3>
                        <p class="bk_ftcc" style="padding-left:0px;">
                            <lhz   data-id="19327_bk_107202_tt_dp4"  data-href='' data-pmkid="0" data-is_del="" class="js-my-replace-txt">Tiktok</lhz>          </p>
                    </div>
                </div>

                <div class="clearfix"></div>
            </div>
        </div>        </div>
</div>

<link rel="stylesheet" type="text/css" href="./css/jquery-confirm.css?31?31">
<link rel="Stylesheet" type="text/css" href="./css/swiper-bundle.min.css?31">
<script src="./js/baguetteBox.min.js"></script>
<link rel="Stylesheet" type="text/css" href="./css/scrollanim.min.css?31">
<script src="./js/swiper-bundle.min.js?31"></script>
<script src="./js/jquery.nav.js?31"></script>
<script src="./js/scrollanim.js?31"></script>
<script src="./js/lazyload.min.js?31"></script>
<script type='text/javascript' src='js/jquery.js'></script>
<script type='text/javascript' src='js/bootstrap.min.js'></script>
<script type='text/javascript' src='js/jquery.collapsible.min.js'></script>
<script type='text/javascript' src='js/swiper.min.js'></script>
<script type='text/javascript' src='js/jquery.countdown.min.js'></script>
<script type='text/javascript' src='js/circle-progress.min.js'></script>
<script type='text/javascript' src='js/jquery.countTo.min.js'></script>
<script type='text/javascript' src='js/jquery.barfiller.js'></script>
<script type='text/javascript' src='js/custom.js'></script>
<script type='text/javascript' src='layer/layer.js'></script>
<script type='text/javascript' src='js/funcJs/base.js'></script>
<script type='text/javascript' src='js/funcJs/uploadFile.js'></script>
<script type='text/javascript' src='js/funcJs/index.js'></script>
<script type='text/javascript'>
    //用户注册
    function register() {
        //获取用户输入
        let username = $("#username").val();
        let email = $("#email").val();
        let pwd = $("#pwd").val();
        let pwdAgain = $("#pwdAgain").val();
        let checkCode1 = $("#emailCheckCode").val();
        let checkCode2 = $("#realCheckCode").val();
        if(username == null || username == "" || email == null || email == ""|| pwd == null
            || pwd == ""|| pwdAgain == null || pwdAgain == "" ||checkCode1 == null || checkCode1 == ""){
            $("#error_msg").text("请将信息输入完整");
        }else{
            if(pwd == pwdAgain){
                if(checkCode1 == checkCode2){
                    //邮箱验证一致
                    //ajax异步交互
                    let url = "/TheCharity/user/register";
                    let args = {"userName":username,"email":email,"password":pwd};
                    $.post(url,args,function (responseEntity) {
                        if(responseEntity.result == "SUCCESS"){
                            //注册成功
                            //跳转登录页面
                            location.href = "login.html";
                        }else{
                            //登录失败
                            //回显错误消息
                            $("#error_msg").text(responseEntity.message);
                            //并刷新验证码
                            $("#realCheckCode").val(' ');
                        }
                    })
                }else{
                    $("#error_msg").text("邮箱验证码错误");
                }
            }else{
                $("#error_msg").text("两次密码不一致，请重新输入");
            }
        }
        return false;
    }

    function getCheckCode() {
        //获取邮箱
        let email = $("#email").val();
        //验证邮箱
        let reg = /^[0-9a-zA-Z_.-]+[@][0-9a-zA-Z_.-]+([.][a-zA-Z]+){1,2}$/;
        let flag = reg.test(email);
        if(flag){
            timeBtn($("#getCode").get(0),60);
            //让后端发送邮件并获取验证码回显表单
            let url = "/TheCharity/user/sendCheckCode";
            let args = {"email":email};
            $.post(url,args,function (responseEntity) {
                if(responseEntity.result == "SUCCESS"){
                    //发送成功
                    //回显验证码
                    layer.msg("验证码发送成功");
                    $("#realCheckCode").val(responseEntity.data);
                }else{
                    //显示错误信息
                    layer.msg(responseEntity.message);
                }
            })
        }else{
            layer.msg("邮箱格式不对请重新输入再获取验证码！！");
        }
    }
    //防止用户一直点击获取验证码
    function timeBtn(e,waitTime) {
        if(waitTime === 0){
            e.disabled = false;
            e.innerHTML = '获取验证码';
            waitTime = 60;
        }else{
            e.disabled = true;
            e.innerHTML = waitTime + '秒后再点击';
            waitTime--;
            setTimeout(function () {
                timeBtn(e,waitTime);
            },1000)
        }
    }
</script>
</html>